/**
 * setup.gs - ç³»çµ±åˆå§‹åŒ–è…³æœ¬ (V2.3)
 * * ç”¨é€”ï¼š
 * å¿«é€Ÿå»ºç«‹æˆ–ä¿®å¾©ç³»çµ±æ‰€éœ€çš„ 7+1 å¼µæ ¸å¿ƒå·¥ä½œè¡¨ã€‚
 * è‹¥å·¥ä½œè¡¨å·²å­˜åœ¨ï¼Œæœƒè·³éä¸è™•ç† (ä¸æœƒè¦†è“‹ç¾æœ‰è³‡æ–™)ã€‚
 * è‹¥å·¥ä½œè¡¨ä¸å­˜åœ¨ï¼Œæœƒè‡ªå‹•å»ºç«‹ä¸¦å¡«å…¥æ¨™æº–è¡¨é ­ (Header)ã€‚
 */

function initProject() {
  const ss = SpreadsheetApp.openById("16IP78MRPyFg73ummLQT8skJV5LbbdEVYSwgFoIrtD5A");
  
  // å®šç¾©æ‰€æœ‰å·¥ä½œè¡¨åŠå…¶è¡¨é ­çµæ§‹
  const sheets = [
    {
      name: "[00_å„€è¡¨æ¿]",
      headers: ["å•†å“åç¨±", "å…§éƒ¨SKU", "ç•¶å‰åº«å­˜", "ç‹€æ…‹", "å»ºè­°å‹•ä½œ"]
      // å‚™è¨»: æ­¤è¡¨è³‡æ–™ç”± InventoryManager è‡ªå‹•æ¼”ç®—
    },
    {
      name: "[00_æ•¸æ“šæš«å­˜å€]",
      headers: ["ã€è¦çš® Shopeeã€‘åŸå§‹è³‡æ–™è²¼ä¸Šè™•", "", "ã€å®˜ç¶² WooCommerceã€‘åŸå§‹è³‡æ–™è²¼ä¸Šè™• (Cæ¬„é–‹å§‹)"]
      // å‚™è¨»: Aæ¬„ç‚ºæ–‡å­—æµ, Cæ¬„ç‚ºè¡¨æ ¼è²¼ä¸Š
    },
    {
      name: "[01_BOMè¨­å®š]",
      headers: ["æˆå“SKU", "åŸæ–™SKU", "æ¶ˆè€—æ•¸é‡", "å‚™è¨»"]
      // å‚™è¨»: V3.0 é ç•™åŠŸèƒ½
    },
    {
      name: "[02_ç”Ÿç”¢ç´€éŒ„]",
      headers: ["æ—¥æœŸ", "ç”Ÿç”¢SKU", "æ•¸é‡", "å‚™è¨»"]
      // å‚™è¨»: æ¬„ä½Dç”¨æ–¼è¨˜éŒ„æ“ä½œè€… (å¦‚: "Appå…¥åº« (è€é—†)")
    },
    {
      name: "[03_éŠ·å”®æ•¸æ“šæ± ]",
      headers: ["æ—¥æœŸ", "å¹³å°", "è¨‚å–®ç·¨è™Ÿ", "å•†å“SKU", "æ•¸é‡", "åŸå§‹è¦æ ¼å­—ä¸²"]
      // å‚™è¨»: éŠ·å”®æµæ°´å¸³
    },
    {
      name: "[04_SKUå°ç…§è¡¨]",
      headers: [
        "å…§éƒ¨SKU",          // A
        "å•†å“åç¨±",          // B
        "æ’¿è²¨ç°¡ç¨±",          // C
        "è­˜åˆ¥é—œéµå­—_è¦çš®",    // D
        "è­˜åˆ¥é—œéµå­—_å®˜ç¶²",    // E
        "å•†å“ç‹€æ…‹",          // F (Active/Soft_Delete)
        "åˆ†é¡",             // G (å•†å“/åŸæ–™/åŒ…æ/çµ„åˆ) [V2.2æ–°å¢]
        "å®‰å…¨åº«å­˜"           // H (æ•´æ•¸) [V2.2æ–°å¢]
      ]
    },
    {
      name: "[05_æ’¿è²¨å–®]",
      headers: ["æ—¥æœŸ", "æ’¿è²¨ä»£ç¢¼", "è¨‚å–®ç·¨è™Ÿ", "ç‰©æµæ–¹å¼"]
      // å‚™è¨»: æ¯æ—¥ç”¢å‡ºçµæœ
    },
    {
      name: "[Backup_Sales]",
      headers: ["æ—¥æœŸ", "å¹³å°", "è¨‚å–®ç·¨è™Ÿ", "å•†å“SKU", "æ•¸é‡", "åŸå§‹è¦æ ¼å­—ä¸²"]
      // å‚™è¨»: [V2.3æ–°å¢] ç”¨æ–¼ Archiver å°å­˜æ­·å²è³‡æ–™
    }
  ];

  // åŸ·è¡Œå»ºç«‹è¿´åœˆ
  sheets.forEach(sheetDef => {
    let sheet = ss.getSheetByName(sheetDef.name);
    
    if (!sheet) {
      // è‹¥ä¸å­˜åœ¨å‰‡å»ºç«‹
      sheet = ss.insertSheet(sheetDef.name);
      // å¯«å…¥è¡¨é ­
      sheet.getRange(1, 1, 1, sheetDef.headers.length).setValues([sheetDef.headers]);
      // å‡çµç¬¬ä¸€åˆ—
      sheet.setFrozenRows(1);
      console.log(`âœ… å·²å»ºç«‹å·¥ä½œè¡¨: ${sheetDef.name}`);
    } else {
      console.log(`â„¹ï¸ å·¥ä½œè¡¨å·²å­˜åœ¨ï¼Œè·³é: ${sheetDef.name}`);
      
      // é€²éšæª¢æŸ¥ï¼šå¦‚æœæ˜¯ SKU è¡¨ï¼Œæª¢æŸ¥æ˜¯å¦éœ€è¦è£œæ¬„ä½æ¨™é¡Œ (é˜²å‘†)
      if (sheetDef.name === "[04_SKUå°ç…§è¡¨]") {
        const lastCol = sheet.getLastColumn();
        if (lastCol < 8) {
          // å¦‚æœæ¬„ä½å°‘æ–¼ 8 (ä»£è¡¨æ˜¯èˆŠç‰ˆ)ï¼Œæé†’ä½¿ç”¨è€…æˆ–è‡ªå‹•è£œä¸Š
          console.warn(`âš ï¸ [04_SKUå°ç…§è¡¨] æ¬„ä½ä¼¼ä¹å°‘æ–¼æ¨™æº– (ç›®å‰ ${lastCol} æ¬„)ï¼Œå»ºè­°æª¢æŸ¥ G/H æ¬„ä½ã€‚`);
        }
      }
    }
  });

  console.log("ğŸ‰ ç³»çµ±åˆå§‹åŒ–æª¢æŸ¥å®Œæˆï¼");
}